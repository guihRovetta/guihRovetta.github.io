<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/iron-icons/av-icons.html">
<link rel="import" href="../../bower_components/neon-animation/web-animations.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="../device-synthesis/device-synthesis.html">
<link href="https://fonts.googleapis.com/css?family=Spectral+SC" rel="stylesheet">

<dom-module id="my-view4">
    <template>
        <style include="shared-styles">
            :host {
                display: block;
                padding: 10px;
                background-color: #3a373e;
                background-image: url("/src/main-app/assets/got_pattern.png");
                background-repeat: repeat;
            }

            p {
                text-align: justify;
            }            
            
            .center {
                text-align: center;
                vertical-align: middle;
            }  
            
            .links {
                text-decoration: none;
                color: #efb142;
            }
            
            .eps{
                max-width: 900px;
                max-height: 905px;
                width: 100%;
                height: 100%;
            }
            
            .divLimit {
                max-width: 900px;
                width: 100%;
            }
            
            h1, h2{
                font-family: 'Spectral SC', serif;
                color: #3a373e;
            }
            
            h1 {
                font-size: 2.5em;
            }
            
            h2 {
                font-size: 1.7em;
            }
            
            .blink {
                color: red !important; 
                animation: blinker 3s linear infinite !important;
            }

            @keyframes blinker {  
                50% { opacity: 0; }
            }   
            
            .control {
                color: #efb142;
                background-color: #3a373e;
                margin: 10px;
            }
            
            .disabled {
                color: #ffffff !important;
                background-color: #757575 !important;
            }
        </style>
       
        <device-synthesis class="control" id="synthesis" text="{{sentence}}" language="pt-BR" rate="1.1"></device-synthesis>
        
        <div class="page horizontal center layout">
            <div class="flex vertical positioning center layout">
                <div class="card divLimit layout center-justified">       
                    <h1>GOTSpoilers</h1>
                    <p>Bem-vindo à aplicação GOTSpoilers, esta é uma coletânea de imagens e textos sobre o que aconteceu na sétima temporada da série Game of Thrones da HBO. Portanto se você não viu e acompanha a série não veja o conteúdo dessa página pois ela contém muitos <strong>SPOILERS</strong>.</p>
                    <p>O funcionamento é simples, basta clicar no botão de "PLAY" e escutar o que aconteceu naquele determinado episódio. Para ouvir o próximo, clique no botão com seta para a direita. Já para voltar, clique no botão com seta para a esquerda. Em qualquer momento você pode interromper clicando no botão de "STOP".</p>      
                </div>

                <div class="card divLimit container layout vertical center"> 
                    <img id="{{id}}" src="{{image}}" class="eps"> 
                    <div class="container layout horizontal center-justified wrap"> 
                        <paper-button raised="" class="control" id="previous" on-click="previous"><iron-icon icon="av:skip-previous"></iron-icon></paper-button>
                        <paper-button raised="" class="control" id="play" on-click="play"><iron-icon icon="av:play-arrow"></iron-icon></paper-button>                      
                        <paper-button raised="" class="control" id="stop" on-click="stop"><iron-icon icon="av:stop"></iron-icon></paper-button>
                        <paper-button raised="" class="control" id="next" on-click="next"><iron-icon icon="av:skip-next"></iron-icon></paper-button>
                    </div>                           
                </div>

                <div class="card divLimit layout center-justified">       
                    <h2>Referências - Imagens e textos utilizados</h2>
                    <p>As imagens abaixo pertencem à <a href="https://www.hbo.com/" class="links">HBO</a> e foram usadas apenas para fins acadêmicos.</p>  
                    <p>Os textos utilizados para cada episódio pertencem à <a href="https://pt.wikipedia.org/wiki/Game_of_Thrones_(7.%C2%AA_temporada)" class="links">Wikipedia</a> e foram usados apenas para fins acadêmicos.</p>     
                </div>   
            </div>
        </div>      
        
    </template>

    <script>
        class MyView4 extends Polymer.Element {
            static get is() {
                return 'my-view4';
            }
            
            static get properties() {
                return {
                    episodes: {
                        type: Object,
                        notify: true,
                        value: function() {
                            return [{
                                    id: 1,
                                    name: 'Pedra do Dragão.',
                                    description: 'Nas Gêmeas, Arya envenena todos os homens Frey, matando-os. Os Caminhantes Brancos marcham em direção à Muralha, onde Tollett permite que Bran e Meera entrem. Em Winterfell, apesar da desaprovação de Sansa, Jon confia nas lealdades das Casas Umber e Karstark, que lutaram ao lado de Ramsay na Batalha dos Bastardos. Na Cidadela, Samwell rouba livros sobre vidro de dragão e descobre um grande depósito em Pedra do Dragão, decidindo contar sobre isso para Jon em uma carta. Mais tarde, Samwell encontra Jorah em uma cela. Nas Terras Fluviais, Arya encontra um grupo de soldados amigáveis dos Lannister, que entendem sua intenção de matar Cersei como uma piada. Thoros mostra para Sandor a visão no fogo; então, Sandor começa a acreditar no Senhor da Luz. Em Porto Real, Jaime explica para Cersei a necessidade crucial de ter aliados. Ela dá as boas-vindas para Euron, que a propõe em casamento em troca de sua Frota de Ferro e uma chance de matar Theon e Yara. Cersei nega devido à desconfiança; então, Euron promete retornar com um "presente" adequado. Em Pedra do Dragão, o lar da Casa Targaryen deixado desocupado por Stannis, Daenerys chega com seu exército e seus dragões.',
                                    image: '/src/main-app/assets/got7_1.jpg'
                                },
                                {
                                    id: 2,
                                    name: 'Nascida da Tormenta.',
                                    description: 'Daenerys envia os Dorneses na frota de Yara para Lançassolar, os Imaculados para Rochedo Casterly, e decide não atacar Porto Real por enquanto, com a intenção de instalar um cerco completo. Ela exige que Varys critique seus erros futuros ao invés de traí-la, como fez com os monarcas anteriores. Melisandre chega e conta a profecia envolvendo Daenerys e Jon. Cersei reúne vários lordes, pedindo suas fidelidades e prometendo para Randyll o título de Guardião do Sul. Qyburn mostra para Cersei uma balista inventada para matar dragões. Arya se encontra com Torta Quente, que lhe conta da ascensão de Jon como Rei do Norte; então, ela decide voltar para Winterfell. Depois de receber a carta de Samwell, Jon vai para Pedra do Dragão na esperança de receber o apoio de Daenerys contra os Caminhantes Brancos, deixando Sansa no comando e avisando Mindinho para não se aproximar dela. Samwell começa um tratamento proibido com Jorah. A frota de Euron ataca a frota de Yara. Obara e Nymeria são mortas, enquanto Ellaria, Tyene e Yara são capturadas. Theon foge da carnificina com medo, pulando no mar.',
                                    image: '/src/main-app/assets/got7_2.jpg'
                                },
                                {
                                    id: 3,
                                    name: 'A Justiça da Rainha.',
                                    description: 'Jon chega em Pedra do Dragão, onde Daenerys exige sua fidelidade. Em vez disso, ele pede ajuda contra o Exército dos Mortos; após um conselho de Tyrion, Daenerys lhes fornece acesso ao vidro de dragão da ilha. Melisandre vai para Volantis. Bran chega em Winterfell e explica alguns de seus poderes para Sansa. Em Porto Real, Euron retorna com Ellaria e Tyene como um presente para Cersei, que promete se casar com ele após a guerra. Então, ela lhe dá o co-controle de seu exército junto com Jaime. Cersei dá para Tyene o mesmo veneno que Ellaria usou para matar Myrcella, obrigando Ellaria a assistir a morte iminente de sua filha. Em Vilavelha, Jorah, que agora está curado, vai embora para encontrar Daenerys. Ebrose decide perdoar Samwell. Verme Cinzento e os Imaculados atacam Rochedo Casterly. No entanto, é revelado que Jaime usou a maioria das forças Lannister para atacar Jardim de Cima, enquanto a frota de Euron chega destruindo os navios dos Imaculados. Jaime e o resto das forças Lannister invadem facilmente Jardim de Cima. Ele dá veneno para Olenna como uma morte rápida e indolor. Depois de beber, ela confessa o envenenamento de Joffrey e exige que ele conte para Cersei.',
                                    image: '/src/main-app/assets/got7_3.jpg'
                                },
                                {
                                    id: 4,
                                    name: 'Os Despojos da Guerra.',
                                    description: 'Arya volta para Winterfell, onde ela reencontra Sansa e treina duelo com Brienne, o que faz com que ambas se impressionem com suas habilidades de luta. Bran, sem emoção, se despede de Meera, dizendo que ele não é mais o garoto que ela acompanhou pelo Norte. Mindinho entrega para Bran a adaga que foi usada para tentar assassiná-lo anteriormente. Cersei promete para o Banco de Ferro um retorno completo em seu investimento, já que uma parte do pagamento vindo de Jardim de Cima chegará em breve. Jon leva Daenerys para a mina de vidro de dragão, onde ele mostra antigas pinturas na caverna que retratam que os Primeiros Homens e os Filhos da Floresta uniram forças contra os mortos-vivos. Mais tarde, Daenerys descobre que o ataque de Rochedo Casterly foi uma armadilha Lannister, com Jardim de Cima sendo tomado pelos Lannister. Apesar das afirmações de Tyrion, ela decide agir. Com Daenerys montada em Drogon e com a cavalaria Dothraki, Jaime e Bronn são pegos de surpresa enquanto supervisionam o envio de ouro, e os Dothraki e o fogo de Drogon dizimam o exército Lannister. Drogon é ferido por uma lança de Bronn, que está controlando a balista escorpião, enquanto Jaime tenta atacar Daenerys. Drogon lança seu suspiro de fogo em Jaime, mas Bronn o atira em um rio.',
                                    image: '/src/main-app/assets/got7_4.jpg'
                                },
                                {
                                    id: 5,
                                    name: 'Atalaialeste.',
                                    description: 'Jaime e Bronn retornam a Porto Real. Contra o aviso de Tyrion, Daenerys queima Randyll e Dickon vivos por permanecerem fiéis a Cersei, o que obriga os outros prisioneiros a jurarem fidelidade a Daenerys. Jorah chega em Pedra do Dragão e se reencontra com Daenerys. Meistre Wolkan alerta Jon e a Cidadela sobre as criaturas que se aproximam de Atalaialeste do Mar. Jon decide viajar além da Muralha e capturar uma criatura para convencer Cersei a aceitar uma aliança temporária. Davos faz com que Tyrion consiga entrar em Porto Real, onde ele se encontra secretamente com Jaime e oferece uma trégua, a qual Cersei aceita, dizendo para Jaime que está grávida. Davos se encontra com Gendry e volta para Pedra do Dragão. Ao perceber que a Cidadela está ignorando a carta de Wolkan, Samwell rouba vários livros e vai embora com Gilly e Pequeno Sam. Em Winterfell, Mindinho percebe que Arya está o espionando e a conduz até uma carta escrita por Sansa em seu quarto. Jon, Jorah e Gendry, juntos com o Cão de Caça, a Irmandade e um grupo do Povo Livre liderado por Tormund, saem de Atalaialeste e passam a Muralha, com a intenção de capturar uma criatura como evidência para Cersei de que o Exército dos Mortos é real.',
                                    image: '/src/main-app/assets/got7_5.jpg'
                                },
                                {
                                    id: 6,
                                    name: 'Além da Muralha.',
                                    description: 'Em Winterfell, Mindinho planeja isolar Sansa, e algumas tensões entre Arya e Sansa crescem depois que Arya descobre sobre a carta enviada por Sansa quando criança, implorando a fidelidade de Robb a Joffrey. Mais tarde, Sansa encontra o saco de rostos de Arya, o qual ela conseguiu em Braavos. Tyrion dá conselhos para Daenerys sobre suas futuras negociações com Cersei. Além da Muralha, Jon lidera um grupo de ataque para capturar uma criatura e levá-la para o Sul como evidência da existência dos Caminhantes Brancos. Depois de capturar uma, o grupo é cercado pelo exército dos Caminhantes Brancos. Jon ordena que Gendry volte para Atalaialeste e envie um corvo para Daenerys, pedindo sua ajuda. Antes do grupo ser morto pelas criaturas, Daenerys chega e começa a queimar as criaturas com seus três dragões. Na tentativa de detê-la, o Rei da Noite, líder dos Caminhantes Brancos, atira sua lança de gelo em um dos dragões de Daenerys, Viserion, e o mata. Daenerys voa para longe, junto com o grupo de ataque do Norte, mas não consegue salvar Jon. Benjen Stark aparece e se sacrifica para que Jon consiga fugir. Mais tarde, Jon e Daenerys conversam, e Jon promete o Norte a Daenerys como Rainha. O Rei da Noite ressuscita Viserion, tornando o dragão parte de seu exército.',
                                    image: '/src/main-app/assets/got7_6.jpg'
                                },
                                {
                                    id: 7,
                                    name: 'O Dragão e o Lobo.',
                                    description: 'Em Porto Real, a criatura é apresentada aos Lannister. Cersei exige a neutralidade de Jon na Grande Guerra, mas ele mantém seu juramento a Daenerys, fazendo com que Cersei vá embora. Tyrion se encontra em particular com Cersei, aparentemente convencendo-a a se aliar. Mais tarde, Cersei revela para Jaime que estava mentindo e, em vez disso, pretende usar a Companhia Dourada de Braavos para garantir sua posse sobre Westeros. Revoltado, Jaime a abandona e vai para o Norte. Em Pedra do Dragão, Theon ganha o respeito de seus homens e os convence a resgatar Yara. Em Winterfell, Mindinho discute o comportamento ameaçador de Arya com Sansa, que convoca um julgamento. Depois de relembrar os atos de traição de Mindinho contra a Casa Stark e o Norte, Sansa permite que Arya o execute. Samwell chega em Winterfell e se encontra com Bran, onde ambos discutem sobre o parentesco de Jon. Eles percebem que Jon é um legítimo Targaryen chamado Aegon e herdeiro válido do Trono de Ferro, com seus pais—Rhaegar Targaryen e Lyanna Stark—tendo se casado em segredo. Em Atalaialeste, Viserion, agora um morto-vivo, derruba parte da Muralha, permitindo que o Exército dos Mortos marche em direção ao sul.',
                                    image: '/src/main-app/assets/got7_7.jpg'
                                }
                            ];
                        }
                    },
                    id: {
                        type: String,
                        notify: true,
                        observer: '_idChanged',
                        reflectToAttribute: true,
                        value: ''
                    },
                    name: {
                        type: String,
                        notify: true,
                        observer: '_nameChanged',
                        reflectToAttribute: true,
                        value: ''
                    },
                    sentence: {
                        type: String,
                        notify: true,
                        observer: '_sentenceChanged',
                        reflectToAttribute: true,
                        value: ''
                    },                  
                    image: {
                        type: String,
                        notify: true,
                        observer: '_imageChanged',
                        reflectToAttribute: true,
                        value: ''
                    },
                    count: {
                        type: Number,
                        notify: true,
                        observer: '_countChanged',
                        reflectToAttribute: true,
                        value: 0
                    },
                    action: {
                        type: Boolean,
                        value: true
                    }
                }
            }
            
            _idChanged(newValue, oldValue) {
                this.id = newValue;
            }
            
            _nameChanged(newValue, oldValue) {
                this.name = newValue;
            }
            
            _sentenceChanged(newValue, oldValue) {
                this.sentence = newValue;
            }
            
            _imageChanged(newValue, oldValue) {
                this.image = newValue;
            }
            
            _countChanged(newValue, oldValue) {
                this.count = newValue;
                this._verify();
            }
            
            constructor() {
                super();
                this.count = 0;
                this.change(this.count);               
            }
            
            connectedCallback() {
                super.connectedCallback(); 
                this.disabledstop(true);
            }  
            
            disabledstop(e){
                this.$.stop.classList.toggle("disabled");
                this.$.stop.disabled = e;
            }
            
            disabledplay(e){
                this.$.play.classList.toggle("disabled");
                this.$.play.disabled = e;
            }
            
            
            disabledcontrols(){
                this.$.stop.classList.add("disabled");
                this.$.stop.disabled = true;
                this.$.play.classList.remove("disabled");
                this.$.play.disabled = false;
            }
            
            change(index){
                this.id = "ep" + this.episodes[index].id;
                this.name = this.episodes[index].name;
                this.sentence = "Em " + this.episodes[index].name + this.episodes[index].description;
                this.image = this.episodes[index].image;
            }   
            
            
            play(){
                this.$.synthesis._begin();
                this.$.synthesis._start();               
                this.disabledstop(false);
                this.disabledplay(true);
            }
            
            stop(){
                this.$.synthesis._stop();
                this.disabledstop(true);
                this.disabledplay(false);
            }                  
            
            next(){
                this.count++;
                this.change(this.count);
                this.$.synthesis._stop();
                this.disabledcontrols();
            }                  
            
            previous(){
                this.count--;
                this.change(this.count);
                this.$.synthesis._stop();
                this.disabledcontrols();
            }
            
            _verify(){
                if(this.count === 0){                                     
                    this.$.next.disabled = false;
                    this.$.previous.classList.add("disabled");
                    this.$.previous.disabled = true;
                }
                else if (this.count === (this.episodes.length - 1)) {
                    this.$.next.classList.add("disabled");
                    this.$.next.disabled = true;
                    this.$.previous.disabled = false;
                }
                else {                
                    this.$.next.classList.remove("disabled");
                    this.$.next.disabled = false;
                    this.$.previous.classList.remove("disabled");
                    this.$.previous.disabled = false;
                }
            }
            
        }
        window.customElements.define(MyView4.is, MyView4);
    </script>
</dom-module>
